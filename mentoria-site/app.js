const $=(s,e=document)=>e.querySelector(s);const state={modules:[]};async function load(){const r=await fetch('data/modules.json');const d=await r.json();state.modules=d.modules.sort((a,b)=>a.order-b.order);}function card(m){const el=document.createElement('article');el.className='card';el.innerHTML=`${m.cover?`<img class="cover" src="${m.cover}" alt=""/>`:''}<div class="body"><span class="tag">Módulo ${m.order}</span><h3>${m.title}</h3><p>${m.objective}</p></div>`;el.addEventListener('click',()=>{location.hash=`#/lesson/${m.id}/${m.slug}`});return el}function home(){const el=document.createElement('div');el.className='container';const grid=document.createElement('div');grid.className='grid';el.appendChild(grid);state.modules.forEach(m=>grid.appendChild(card(m)));return el}function sectionHTML(s){return `<section class="section"><h4>${s.title}</h4><ul>${(s.items||[]).map(i=>`<li>${i}</li>`).join('')}</ul></section>`}function lesson(id){const m=state.modules.find(x=>x.id===id);const el=document.createElement('div');el.className='view';el.innerHTML=`<div class="hero"><div><span class="tag">Módulo ${m.order}</span><h2>${m.title}</h2><p>${m.objective}</p><p class="small">/lesson/${m.id}/${m.slug}</p><a href="#/">← Voltar</a></div><div>${m.cover?`<img src="${m.cover}" alt=""/>`:''}</div></div>${m.sections.map(sectionHTML).join('')}`;return el}function router(){const app=$('#app');app.innerHTML='';const hash=location.hash||'#/' ;const p=hash.split('/');if(p[1]===''||p[1]==='#'){app.appendChild(home())}else if(p[1]==='lesson'&&p[2]){app.appendChild(lesson(p[2]))}else{app.innerHTML='<div class="container"><p>Rota não encontrada.</p></div>'}}(async()=>{document.getElementById('year').textContent=new Date().getFullYear();await load();router();addEventListener('hashchange',router);})();