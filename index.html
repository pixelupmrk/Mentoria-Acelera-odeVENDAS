<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>PixelUp Mentoria</title>
<meta name="theme-color" content="#0ea5ff" />

<style>
  :root{
    --bg:#0b0f1a;--card:#0e1626;--primary:#0ea5ff;--text:#e6f1ff;--muted:#8aa3c2;
    --glow:0 12px 40px rgba(0,0,0,.35), inset 0 0 40px rgba(14,165,255,.08)
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;color:var(--text);
    background:radial-gradient(1000px 500px at 20% -10%, rgba(51,204,255,.16), transparent 60%),
               radial-gradient(800px 400px at 100% 10%, rgba(14,165,255,.14), transparent 60%),
               var(--bg);
  }
  .topbar{position:sticky;top:0;display:flex;align-items:center;justify-content:space-between;gap:12px;
    padding:12px 16px;background:rgba(14,22,38,.9);backdrop-filter:blur(8px);
    border-bottom:1px solid rgba(14,165,255,.25);z-index:10}
  .brand{font-weight:900;font-size:20px;letter-spacing:.3px;text-shadow:0 0 12px rgba(14,165,255,.5)}
  .brand span{color:var(--primary)}
  .tools{display:flex;gap:10px;align-items:center}
  .search{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.12);border-radius:12px;
    padding:10px 12px;color:var(--text);min-width:240px;outline:none}
  .btn{cursor:pointer;padding:10px 14px;border-radius:12px;border:1px solid rgba(14,165,255,.35);
    background:linear-gradient(180deg, rgba(14,165,255,.18), rgba(14,165,255,.06));color:var(--text);font-weight:700}
  .btn.ghost{background:transparent}
  .container{max-width:1080px;margin:24px auto;padding:0 16px}
  .card{background:linear-gradient(180deg, rgba(14,165,255,.08), rgba(14,165,255,.03));border:1px solid rgba(14,165,255,.25);
    border-radius:20px;box-shadow:var(--glow);padding:20px}
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px}
  .module{padding:16px;border-radius:16px;border:1px solid rgba(14,165,255,.25);
    background:linear-gradient(180deg, rgba(14,165,255,.12), rgba(14,165,255,.05))}
  .module h3{margin:0 0 6px}
  .cover{
    width:100%;aspect-ratio:16/9;border-radius:14px;border:1px solid rgba(14,165,255,.25);
    background:
      radial-gradient(600px 200px at 20% 0%, rgba(14,165,255,.2), transparent 60%),
      radial-gradient(600px 200px at 100% 40%, rgba(51,204,255,.15), transparent 60%),
      #0d1322 center/cover no-repeat;
    overflow:hidden;display:grid;place-items:center
  }
  .cover img{width:100%;height:100%;object-fit:cover;border-radius:14px;display:block}
  .progress{height:10px;background:rgba(255,255,255,.08);border-radius:999px;overflow:hidden;margin:6px 0 8px}
  .progress > i{display:block;height:100%;background:linear-gradient(90deg, var(--primary), rgba(51,204,255,1));width:0%}
  .lesson{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border:1px solid rgba(14,165,255,.25);
    border-radius:12px;margin:10px 0;background:rgba(14,165,255,.06)}
  .badge{padding:4px 8px;border-radius:10px;background:rgba(14,165,255,.16);border:1px solid rgba(14,165,255,.35);font-size:12px}
  .note{color:var(--muted);font-size:14px}
  hr{border:0;height:1px;background:linear-gradient(90deg, rgba(255,255,255,0), rgba(14,165,255,.4), rgba(255,255,255,0));margin:16px 0}
  .form label{display:block;font-weight:600;margin:8px 0 6px}
  .form input[type=text], .form textarea, .form select{
    width:100%;padding:10px 12px;border-radius:12px;border:1px solid rgba(255,255,255,.16);
    background:rgba(255,255,255,.06);color:var(--text);outline:none
  }
  .form textarea{min-height:110px;resize:vertical}
  .pill{display:inline-block;padding:6px 10px;border:1px solid rgba(14,165,255,.35);border-radius:999px;margin:2px 6px 2px 0;font-size:12px}
  .foot{padding:24px;text-align:center;color:var(--muted);font-size:14px}
  @media (max-width:560px){ .search{min-width:160px} }
</style>
</head>
<body>
  <header class="topbar">
    <div class="brand">Pixel<span>Up</span> Mentoria</div>
    <div class="tools">
      <input id="search" class="search" type="search" placeholder="Buscar aulas…" />
      <button id="homeBtn" class="btn ghost" title="Início">Início</button>
    </div>
  </header>

  <main id="app" class="container"></main>
  <footer class="foot">© PixelUp Marketing Digital & Mídia</footer>

<script>
/* ===========================
   DADOS • Módulos 1–8 + aulas
   =========================== */
const DATA = {
  org: "PixelUp",
  modules: [
    {
      slug:"m1", title:"Módulo 1 • Fundamentos do Negócio e Posicionamento",
      cover:"assets/cover-m1.png",
      summary:"Persona ideal, proposta de valor e escolha do plano de serviço.",
      lessons:[
        {
          slug:"m1-l1", title:"Definição da Persona Ideal (com exercícios)",
          cover:"assets/cover-m1.png",
          presentation:[
            "Mapeie dores, objetivos e contexto da sua persona.",
            "Liste canais onde ela consome conteúdo e compra.",
            "Consolide um perfil claro para orientar comunicação."
          ],
          form:[
            {id:"persona_nome",label:"Nome (apelido) da persona",type:"text"},
            {id:"persona_dores",label:"Dores/objeções principais",type:"textarea"},
            {id:"persona_objetivos",label:"Objetivos/resultados desejados",type:"textarea"},
            {id:"persona_canais",label:"Canais/ambientes onde está presente",type:"text"},
            {id:"persona_resumo",label:"Frase-resumo (quem é, o que busca, como você ajuda)",type:"textarea"}
          ]
        },
        {
          slug:"m1-l2", title:"Proposta de Valor e Diferenciação",
          cover:"assets/cover-m1.png",
          presentation:[
            "Clareza de promessa → valor percebido maior.",
            "Diferencial: método, experiência, nicho, entrega."
          ],
          form:[
            {id:"pv_frase",label:"Complete: Eu ajudo [persona] a [transformação] através de [diferencial].",type:"textarea"},
            {id:"pv_provas",label:"Provas (cases, depoimentos, números) para sustentar a proposta",type:"textarea"}
          ]
        },
        {
          slug:"m1-l3", title:"Escolha do Plano de Serviço Ideal",
          cover:"assets/cover-m1.png",
          presentation:[
            "Alinhe preço com escopo e estágio do negócio.",
            "Defina o que é básico x intermediário x avançado."
          ],
          form:[
            {id:"plano_escolhido",label:"Plano escolhido (Básico/Intermediário/Avançado)",type:"text"},
            {id:"plano_just",label:"Justificativa (por que esse plano agora?)",type:"textarea"}
          ]
        }
      ]
    },
    {
      slug:"m2", title:"Módulo 2 • O Algoritmo do Meta (Facebook & Instagram)",
      cover:"assets/cover-m2.png",
      summary:"Como a Meta entrega conteúdos, fatores de alcance e engajamento inicial.",
      lessons:[
        {
          slug:"m2-l1", title:"Como o algoritmo funciona e entrega conteúdos",
          cover:"assets/cover-m2.png",
          presentation:[
            "O feed testa seu conteúdo para grupos pequenos.",
            "Bons sinais (visualizações, salvamentos, comentários) ampliam a entrega."
          ],
          form:[
            {id:"qtd_testes",label:"Quais sinais seu conteúdo atual mais recebe?",type:"text"},
            {id:"melhorar",label:"O que fará para melhorar retenção nos 3 primeiros segundos?",type:"textarea"}
          ]
        },
        {
          slug:"m2-l2", title:"O que influencia o alcance orgânico",
          cover:"assets/cover-m2.png",
          presentation:["Frequência, qualidade do assunto, tempo de exibição, interações salvas/compartilhadas."],
          form:[
            {id:"freq",label:"Frequência possível por semana",type:"text"},
            {id:"pilares",label:"3 pilares de conteúdo para o mês",type:"textarea"}
          ]
        },
        {
          slug:"m2-l3", title:"Engajamento inicial & comportamento do usuário",
          cover:"assets/cover-m2.png",
          presentation:["Os primeiros minutos contam; relacionamento prévio com seu perfil ajuda."],
          form:[
            {id:"gatilhos_iniciais",label:"Ganchos que vai testar nos próximos 3 posts",type:"textarea"}
          ]
        },
        {
          slug:"m2-l4", title:"Dica prática: comece com um Gancho Forte",
          cover:"assets/cover-m2.png",
          presentation:["Ex.: “3 erros que estão travando seu Instagram…” ou “Antes de postar hoje, faça isto…”"],
          form:[
            {id:"ganchos",label:"Escreva 5 ganchos agora",type:"textarea"}
          ]
        }
      ]
    },
    {
      slug:"m3", title:"Módulo 3 • Cronograma de Postagens Estratégico",
      cover:"assets/cover-m3.png",
      summary:"Melhores horários, frequência por nicho e modelos de calendário.",
      lessons:[
        {
          slug:"m3-l1", title:"Melhores horários e dias para postar",
          cover:"assets/cover-m3.png",
          presentation:["Baseie-se nos Insights do Instagram (quando seguidores estão online)."],
          form:[
            {id:"horarios",label:"Horários/dias ideais (a partir dos seus Insights)",type:"textarea"}
          ]
        },
        {
          slug:"m3-l2", title:"Frequência ideal por nicho",
          cover:"assets/cover-m3.png",
          presentation:["Estética (4–5/sem), B2B (3/sem), varejo (quase diário) — ajuste à sua realidade."],
          form:[
            {id:"frequencia",label:"Frequência definida para seu nicho",type:"text"}
          ]
        },
        {
          slug:"m3-l3", title:"Templates e modelos de calendário",
          cover:"assets/cover-m3.png",
          presentation:["Monte um calendário Mensal com categorias: educar, prova social, CTA, oferta."],
          form:[
            {id:"calendario",label:"Rascunho do seu calendário (semana 1)",type:"textarea"}
          ]
        }
      ]
    },
    {
      slug:"m4", title:"Módulo 4 • Conteúdo que Conecta",
      cover:"assets/cover-m4.png",
      summary:"Vídeos que engajam, edição prática e design com identidade.",
      lessons:[
        {
          slug:"m4-l1", title:"Vídeos que engajam: gancho, valor e CTA",
          cover:"assets/cover-m4.png",
          presentation:["Roteiro: Gancho → Promessa → Entrega de valor → CTA."],
          form:[
            {id:"roteiro",label:"Escreva o roteiro do seu próximo vídeo (1 minuto)",type:"textarea"}
          ]
        },
        {
          slug:"m4-l2", title:"Edição prática (CapCut/InShot)",
          cover:"assets/cover-m4.png",
          presentation:["Cortes rápidos, legendas automáticas, música leve, identidade visual."],
          form:[
            {id:"template_edicao",label:"Checklist do seu template de edição",type:"textarea"}
          ]
        },
        {
          slug:"m4-l3", title:"Design com Canva: layout e identidade",
          cover:"assets/cover-m4.png",
          presentation:["Fontes legíveis, contraste, respiro, consistência de marca."],
          form:[
            {id:"padroes_visuais",label:"Defina fontes/cores/padrões que usará",type:"textarea"}
          ]
        },
        {
          slug:"m4-l4", title:"Desafio: 1 dica em 1 minuto",
          cover:"assets/cover-m4.png",
          presentation:["Publique 1 dica com gancho forte + CTA para salvar/compartilhar."],
          form:[
            {id:"tema_desafio",label:"Tema e CTA do vídeo-desafio",type:"text"}
          ]
        }
      ]
    },
    {
      slug:"m5", title:"Módulo 5 • Copywriting com ChatGPT",
      cover:"assets/cover-m5.png",
      summary:"Textos persuasivos com IA, fórmulas e prompts prontos.",
      lessons:[
        {
          slug:"m5-l1", title:"Como criar textos persuasivos com IA",
          cover:"assets/cover-m5.png",
          presentation:["Dê contexto, objetivo, persona e restrições claras à IA."],
          form:[
            {id:"briefing_ia",label:"Briefing que você passará para a IA (tema, objetivo, persona, tom)",type:"textarea"}
          ]
        },
        {
          slug:"m5-l2", title:"Fórmulas: AIDA, PAS, 4Ps",
          cover:"assets/cover-m5.png",
          presentation:["Escolha a fórmula e aplique na sua legenda/anúncio."],
          form:[
            {id:"formula",label:"Qual fórmula usará (AIDA, PAS, 4Ps) e por quê?",type:"text"},
            {id:"texto",label:"Primeiro rascunho do texto usando a fórmula",type:"textarea"}
          ]
        },
        {
          slug:"m5-l3", title:"Prompts inteligentes + exemplos",
          cover:"assets/cover-m5.png",
          presentation:["Especifique tarefa, formato, tamanho, tom e exemplos."],
          form:[
            {id:"prompt_base",label:"Seu Prompt Base PixelUp (modelo fixo)",type:"textarea"}
          ]
        },
        {
          slug:"m5-l4", title:"Títulos e legendas que geram cliques",
          cover:"assets/cover-m5.png",
          presentation:["Use números, listas, perguntas e benefícios claros."],
          form:[
            {id:"titulos",label:"Escreva 10 títulos/aberturas (ganchos)",type:"textarea"}
          ]
        }
      ]
    },
    {
      slug:"m6", title:"Módulo 6 • Implementação de CRM",
      cover:"assets/cover-m6.png",
      summary:"O que é CRM, ferramentas e funil básico de vendas.",
      lessons:[
        {
          slug:"m6-l1", title:"O que é CRM e por que sua empresa precisa",
          cover:"assets/cover-m6.png",
          presentation:["CRM centraliza contatos, histórico e oportunidades."],
          form:[
            {id:"objetivo_crm",label:"Qual seu objetivo principal com o CRM?",type:"text"}
          ]
        },
        {
          slug:"m6-l2", title:"Ferramentas gratuitas e pagas (Trello/HubSpot/RD…)",
          cover:"assets/cover-m6.png",
          presentation:["Comece simples e evolua conforme volume e time."],
          form:[
            {id:"ferramenta",label:"Ferramenta escolhida e motivo",type:"text"}
          ]
        },
        {
          slug:"m6-l3", title:"Funil básico e organização de leads",
          cover:"assets/cover-m6.png",
          presentation:["Novo Lead → Contato → Proposta → Negociação → Fechado."],
          form:[
            {id:"etapas",label:"Etapas do seu funil (escreva/ajuste)",type:"textarea"},
            {id:"proximo_follow",label:"Próximo follow-up (data/ação)",type:"text"}
          ]
        }
      ]
    },
    {
      slug:"m7", title:"Módulo 7 • Processo Comercial e Técnicas de Venda",
      cover:"assets/cover-m7.png",
      summary:"Pitch que gera interesse, rapport e follow-up consultivo.",
      lessons:[
        {
          slug:"m7-l1", title:"Pitch comercial que gera interesse",
          cover:"assets/cover-m7.png",
          presentation:["Quem você ajuda, qual problema resolve e seu diferencial — em 15–30s."],
          form:[
            {id:"pitch",label:"Seu pitch de 30s",type:"textarea"}
          ]
        },
        {
          slug:"m7-l2", title:"Rapport, gatilhos e espelhamento",
          cover:"assets/cover-m7.png",
          presentation:["Conexão genuína + prova social/autoridade; espelhe linguagem."],
          form:[
            {id:"gatilhos",label:"Gatilhos que você usará (e como)",type:"textarea"}
          ]
        },
        {
          slug:"m7-l3", title:"Follow-up eficiente e sem pressão",
          cover:"assets/cover-m7.png",
          presentation:["Traga novo valor a cada contato; registre no CRM."],
          form:[
            {id:"roteiro_follow",label:"Roteiro do seu próximo follow-up",type:"textarea"}
          ]
        }
      ]
    },
    {
      slug:"m8", title:"Módulo 8 • Conexão com a Audiência e Humanização",
      cover:"assets/cover-m8.png",
      summary:"Autenticidade, bastidores e comunidade leal.",
      lessons:[
        {
          slug:"m8-l1", title:"Conexão real com o público (sem forçar)",
          cover:"assets/cover-m8.png",
          presentation:["Mostre valores e rotina com autenticidade; fale como para um amigo."],
          form:[
            {id:"pilares_conexao",label:"3 pilares de conexão (temas e histórias)",type:"textarea"}
          ]
        },
        {
          slug:"m8-l2", title:"Bastidores, vulnerabilidade e stories",
          cover:"assets/cover-m8.png",
          presentation:["Use stories para processo e aprendizados (sem perfeição)."],
          form:[
            {id:"bastidores",label:"5 ideias de bastidores para stories",type:"textarea"}
          ]
        },
        {
          slug:"m8-l3", title:"Comunidade engajada e leal",
          cover:"assets/cover-m8.png",
          presentation:["Responda DMs, faça perguntas e cite seguidores pelo nome."],
          form:[
            {id:"plano_comunidade",label:"Plano simples de comunidade (rituais, quadros, frequência)",type:"textarea"}
          ]
        }
      ]
    }
  ]
};

/* ===========================
   ESTADO & UTILITÁRIOS
   =========================== */
const $ = (sel, el=document)=>el.querySelector(sel);
const app = $("#app");
const STORAGE = {
  keyAns: "pxup-answers",
  keyProg: "pxup-progress",
  getAnswers(){ return JSON.parse(localStorage.getItem(this.keyAns)||"{}"); },
  setAnswers(v){ localStorage.setItem(this.keyAns, JSON.stringify(v)); },
  getProgress(){ return JSON.parse(localStorage.getItem(this.keyProg)||"{\"done\":{}}"); },
  setProgress(v){ localStorage.setItem(this.keyProg, JSON.stringify(v)); }
};
function pct(done,total){ return total? Math.round((done/total)*100) : 0; }
function modStats(mod){
  const prog = STORAGE.getProgress().done||{};
  const total = mod.lessons.length;
  const done = mod.lessons.filter(l=>prog[`${mod.slug}/${l.slug}`]).length;
  return {done,total,pct:pct(done,total)};
}
function allStats(){
  const totals = DATA.modules.map(modStats);
  const done = totals.reduce((s,t)=>s+t.done,0);
  const total = totals.reduce((s,t)=>s+t.total,0);
  return {done,total,pct:pct(done,total)};
}
function saveForm(modSlug, lesSlug){
  const ans = STORAGE.getAnswers();
  ans[`${modSlug}/${lesSlug}`] = {};
  [...app.querySelectorAll("[data-field]")].forEach(input=>{
    ans[`${modSlug}/${lesSlug}`][input.dataset.field] = input.value.trim();
  });
  STORAGE.setAnswers(ans);
}
function loadForm(modSlug, lesSlug){
  const ans = STORAGE.getAnswers()[`${modSlug}/${lesSlug}`]||{};
  [...app.querySelectorAll("[data-field]")].forEach(input=>{
    const v = ans[input.dataset.field];
    if(v!=null) input.value = v;
  });
}
function markDone(modSlug, lesSlug){
  const prog = STORAGE.getProgress(); prog.done ||= {};
  prog.done[`${modSlug}/${lesSlug}`] = true; STORAGE.setProgress(prog);
}

/* ===========================
   RENDERIZAÇÃO
   =========================== */
function renderHome(){
  const stats = allStats();
  app.innerHTML = `
    <section class="card">
      <h1>Mentoria PixelUp • App de Aulas</h1>
      <p class="note">Preencha os questionários práticos e acompanhe seu avanço. Tudo fica salvo neste dispositivo.</p>
      <div style="display:grid;grid-template-columns:120px 1fr;gap:12px;align-items:center">
        <div class="badge">Progresso geral</div>
        <div>
          <div class="progress"><i style="width:${stats.pct}%"></i></div>
          <small>${stats.done}/${stats.total} aulas • ${stats.pct}%</small>
        </div>
      </div>
    </section>
    <section class="grid" style="margin-top:16px">
      ${DATA.modules.map(m=>{
        const s = modStats(m);
        return `
        <article class="module">
          <div class="cover">${m.cover?`<img src="${m.cover}" onerror="this.remove()">`:''}</div>
          <h3 style="margin:10px 0 0">${m.title}</h3>
          <p class="note">${m.summary}</p>
          <div class="progress"><i style="width:${s.pct}%"></i></div>
          <small>${s.done}/${s.total} aulas</small>
          <div style="margin-top:10px"><a class="btn" href="#/module/${m.slug}">Ver aulas</a></div>
        </article>`;
      }).join("")}
    </section>`;
}

function renderModule(slug){
  const m = DATA.modules.find(x=>x.slug===slug);
  if(!m){ app.innerHTML = `<section class="card"><p>Módulo não encontrado.</p></section>`; return; }
  const s = modStats(m);
  app.innerHTML = `
    <section class="card">
      <a class="btn ghost" href="#/">← Início</a>
      <div class="cover" style="margin-top:10px">${m.cover?`<img src="${m.cover}" onerror="this.remove()">`:''}</div>
      <h2 style="margin:10px 0">${m.title}</h2>
      <p class="note">${m.summary}</p>
      <div class="progress"><i style="width:${s.pct}%"></i></div>
      <small>${s.done}/${s.total} aulas</small>
      <hr/>
      ${m.lessons.map(l=>{
        const done = (STORAGE.getProgress().done||{})[`${m.slug}/${l.slug}`];
        return `
          <div class="lesson">
            <div>
              <strong>${l.title}</strong><br>
              <small class="note">${done?'Concluída':'Pendente'}</small>
            </div>
            <a class="btn" href="#/lesson/${m.slug}/${l.slug}">${done?'Revisar':'Abrir'}</a>
          </div>`;
      }).join("")}
    </section>`;
}

function renderLesson(mSlug,lSlug){
  const m = DATA.modules.find(x=>x.slug===mSlug);
  const l = m?.lessons.find(x=>x.slug===lSlug);
  if(!m||!l){ app.innerHTML = `<section class="card"><p>Aula não encontrada.</p></section>`; return; }

  app.innerHTML = `
    <section class="card">
      <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center">
        <a class="btn ghost" href="#/module/${m.slug}">← ${m.title}</a>
        <span class="badge">Aula</span>
      </div>
      <div class="cover" style="margin-top:10px">${l.cover?`<img src="${l.cover}" onerror="this.remove()">`:''}</div>
      <h2 style="margin:10px 0">${l.title}</h2>

      <h3>Apresentação</h3>
      <ul class="note" style="line-height:1.6;margin-top:6px">
        ${l.presentation.map(p=>`<li>${p}</li>`).join("")}
      </ul>

      <hr/>

      <h3>Questionário Prático</h3>
      <form class="form" oninput="/* autosave */">
        ${l.form.map(q=>{
          const base = `<label for="${q.id}">${q.label}</label>`;
          if(q.type==="text"){
            return `${base}<input data-field="${q.id}" id="${q.id}" type="text" placeholder="Digite aqui..." />`;
          } else if(q.type==="select"){
            return `${base}<select data-field="${q.id}" id="${q.id}">${(q.options||[]).map(o=>`<option>${o}</option>`).join("")}</select>`;
          }
          return `${base}<textarea data-field="${q.id}" id="${q.id}" placeholder="Escreva aqui..."></textarea>`;
        }).join("")}
      </form>

      <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:12px">
        <button id="saveBtn" class="btn">Salvar respostas</button>
        <button id="doneBtn" class="btn ghost">Marcar como concluída</button>
        <button id="exportBtn" class="btn ghost">Exportar (.json)</button>
        <button id="printBtn" class="btn ghost">Imprimir</button>
      </div>

      <p id="status" class="note" style="margin-top:8px"></p>
    </section>`;

  // eventos
  $("#saveBtn").addEventListener("click", ()=>{ saveForm(m.slug,l.slug); flash("Respostas salvas!"); });
  $("#doneBtn").addEventListener("click", ()=>{ saveForm(m.slug,l.slug); markDone(m.slug,l.slug); flash("Aula marcada como concluída."); });
  $("#exportBtn").addEventListener("click", ()=>{
    saveForm(m.slug,l.slug);
    const data = STORAGE.getAnswers()[`${m.slug}/${l.slug}`]||{};
    const blob = new Blob([JSON.stringify({module:m.title,lesson:l.title,answers:data},null,2)], {type:"application/json"});
    const a = document.createElement("a"); a.href = URL.createObjectURL(blob);
    a.download = `${m.slug}-${l.slug}-respostas.json`; a.click();
  });
  $("#printBtn").addEventListener("click", ()=>window.print());

  // carregar valores salvos
  loadForm(m.slug,l.slug);

  function flash(msg){ const s=$("#status"); s.textContent=msg; setTimeout(()=>s.textContent="",2000); }
}

/* ===========================
   ROTEAMENTO & BUSCA
   =========================== */
function router(){
  const parts = (location.hash||"").slice(1).split("/").filter(Boolean);
  if(parts.length===0) return renderHome();
  if(parts[0]==="module" && parts[1]) return renderModule(parts[1]);
  if(parts[0]==="lesson" && parts[1] && parts[2]) return renderLesson(parts[1], parts[2]);
  renderHome();
}
window.addEventListener("hashchange", router);
$("#homeBtn").addEventListener("click", ()=>{ location.hash = ""; });

$("#search").addEventListener("input", (e)=>{
  const q = e.target.value.toLowerCase().trim();
  if(!q){ router(); return; }
  // busca por título/summary
  const results = [];
  DATA.modules.forEach(m=>{
    m.lessons.forEach(l=>{
      const hay = (m.title+" "+m.summary+" "+l.title+" "+(l.presentation||[]).join(" ")).toLowerCase();
      if(hay.includes(q)) results.push({m,l});
    });
  });
  app.innerHTML = `
    <section class="card">
      <h2>Resultados para: “${q}”</h2>
      ${results.length? results.map(({m,l})=>`
        <div class="lesson">
          <div><strong>${l.title}</strong><br><small class="note">${m.title}</small></div>
          <a class="btn" href="#/lesson/${m.slug}/${l.slug}">Abrir</a>
        </div>
      `).join("") : `<p class="note">Nada encontrado.</p>`}
    </section>`;
});

// primeira renderização
router();
</script>
</body>
</html>
